================================================================================
PrimingHub - Agent Instructions for Multi-Agent Development
================================================================================
Date: 23 December 2025
Author: Dr. Shir Sivroni
================================================================================

1. OVERVIEW
===========

This document provides instructions for AI agents (Auto-Claude or similar)
working on the PrimingHub project. Agents work in PAIRS:
- Agent A: Creates/implements code
- Agent B: Verifies/validates Agent A's work

================================================================================

2. CRITICAL RULE - NEVER OVERWRITE FILES
=========================================

**IRON LAW: NEVER overwrite an existing file!**

**Protocol:**
1. Before ANY file modification - check if file exists
2. If exists -> Copy to new version FIRST (e.g., file.html -> file_v2.html)
3. Only then modify the NEW copy
4. NEVER modify the original directly

**Why this matters:**
- Each file represents hours of work
- Agents cannot "remember" everything from previous sessions
- Overwriting destroys context that took time to build
- Versioned copies allow rollback and comparison

**Naming conventions for new versions:**
- index.html -> index_v32.html
- index.html -> index_23_DEC_2025.html
- core.js -> core_backup_23_DEC_2025.js

================================================================================

3. AGENT PAIR STRUCTURE
=======================

Each paradigm/experiment gets its own numbered folder:
- AGENTS/PAIR_01_STROOP/
- AGENTS/PAIR_02_SEMANTIC/
- AGENTS/PAIR_03_AMP/
- etc.

Inside each folder:
/PAIR_XX_NAME/
  ├── TASK.txt           # Task description and requirements
  ├── CREATOR_LOG.txt    # Agent A's work log
  ├── VERIFIER_LOG.txt   # Agent B's verification log
  ├── STATUS.txt         # Current status (pending/in_progress/completed/failed)
  ├── SUMMARY.txt        # REQUIRED: Summary of what was done (both agents update)
  └── OUTPUT/            # Deliverables from this pair

**SUMMARY.txt is MANDATORY!**
Each agent MUST update SUMMARY.txt with:
- What was created/changed
- Key decisions made and why
- Files added/modified (with paths)
- Any issues encountered and how they were resolved
- What the next agent needs to know

================================================================================

4. AGENT ROLES
==============

AGENT A (Creator):
- Reads task from TASK.txt
- Implements the paradigm/experiment
- Documents all decisions in CREATOR_LOG.txt
- Places output in OUTPUT/ folder
- Updates STATUS.txt to "ready_for_verification"

AGENT B (Verifier):
- Waits for STATUS.txt = "ready_for_verification"
- Reviews Agent A's code thoroughly
- Tests ALL functionality (run the experiment, check Supabase saves data)
- Documents ALL findings in VERIFIER_LOG.txt:
  * What was tested
  * What works correctly
  * What doesn't work (with specific error messages)
  * Suggestions for fixes
  * Code quality observations
- Updates SUMMARY.txt with verification results
- Updates STATUS.txt to "completed" or "needs_revision"

**VERIFIER_LOG.txt must include:**
1. Date and time of verification
2. List of tests performed
3. Results for each test (PASS/FAIL with details)
4. Screenshots or console logs if errors found
5. Specific line numbers if bugs found
6. Recommendations for Agent A if revision needed

================================================================================

5. PROJECT CONTEXT
==================

**Project Name:** PrimingHub (not PrimingToolbox)
**Vision:** "The GitHub of Priming Experiments"

**Three-Layer Architecture:**

Layer 1: Core (shared modules)
- timing.js - precise timing
- stimuli.js - stimulus loading/display
- responses.js - response collection
- data.js - Supabase integration
- ui.js - basic UI components

Layer 2: Paradigms (~15-20 base paradigms)
- Each paradigm = unique code using core
- Examples: Stroop, Semantic, AMP, Social, Evaluative, Subliminal

Layer 3: Built-in Experiments (~50-100)
- Each experiment = unique code (not just config!)
- Examples: stroop-bilingual-he-en, semantic-lexical-decision, amp-faces

Layer 4: Custom Experiments (thousands, created by experimenters)
- Config only, built on paradigms

**User Model (Three Layers):**

Layer A: Developer (Shir)
- Builds the platform
- Creates paradigms (base experiment types)
- Creates built-in experiments

Layer B: Experimenters (נסיינים) - Researchers who USE the platform
- Register with email + experiment ID
- Choose a paradigm or built-in experiment
- Customize parameters (stimuli, timing, responses)
- Generate shareable link for their experiment
- Send link to participants
- Download their data ("Get My Data" button)
- Can create THOUSANDS of customized experiments

Layer C: Participants (משתתפים)
- Receive link from experimenter
- Complete experiment in browser
- Data saved automatically to Supabase

**Experimenter Registration System:**
- Each experimenter identified by: email + experiment_id
- Data separation: each experimenter sees ONLY their own data
- Row Level Security in Supabase
- External ID system for Prolific/MTurk/SONA (prevents duplicates)

================================================================================

6. DATABASE - SUPABASE
======================

**Connection Details:**
- Host: db.luhgdmzksitdkbysdfbr.supabase.co
- Project URL: https://luhgdmzksitdkbysdfbr.supabase.co
- Project ID: luhgdmzksitdkbysdfbr (NOT the old bgbhvvaykmkeoniagfap!)

**API Keys (for JavaScript client):**
- Anon Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx1aGdkbXprc2l0ZGtieXNkZmJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MjU0MDMsImV4cCI6MjA4MDEwMTQwM30.kxiMmJE4N5U5pM-3d81URKCwZ5PSsE-19AIr5KWOMlQ

**PostgreSQL Direct Access (for queries/reports):**
- postgresql://postgres:Cc918273645*@db.luhgdmzksitdkbysdfbr.supabase.co:5432/postgres

**Table: experiment_results**
Columns:
- experiment_id
- participant_id
- trial_number
- language
- ink_color
- word_meaning
- congruent
- response
- correct
- rt
- experimenter_email
- user_experiment_id
- external_id

**Usage in JavaScript:**
```javascript
const supabaseUrl = 'https://luhgdmzksitdkbysdfbr.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'; // anon key
const supabase = supabase.createClient(supabaseUrl, supabaseKey);
```

================================================================================

7. PARADIGM DIFFERENCES
=======================

Different priming paradigms are FUNDAMENTALLY DIFFERENT:

| Paradigm    | What's Special                                      |
|-------------|-----------------------------------------------------|
| Stroop      | A and B presented simultaneously (word+color)       |
| Semantic    | A then B sequentially, with variable SOA            |
| AMP         | image -> mask -> target, critical timings           |
| Social      | Sometimes A is a full task (scrambled sentences)    |
| Evaluative  | Repeated pairings, not single trial                 |
| Subliminal  | Below-threshold presentation + masks                |

These differences require unique code for:
- Stimulus types (text, image, audio, video)
- Trial structures (single trial, blocks, sequences)
- Response types (keyboard, mouse, time, multiple choice)
- Timing (simultaneous, sequential, subliminal)
- Trial logic (feedback, what happens after response)

================================================================================

8. CODE STANDARDS
=================

1. Use ES6+ JavaScript
2. Comment in English
3. Use meaningful variable names
4. Follow existing code style in the project
5. Always test before declaring complete
6. Ensure Supabase integration works
7. Maintain visual consistency (glassmorphism, dark theme)

Colors:
- Teal: #169999
- Pink: #ff4db8
- Wine: #990f23

================================================================================

9. COMMUNICATION
================

Agents do NOT communicate directly with each other.

Communication happens through:
1. TASK.txt - task definition
2. STATUS.txt - current state
3. CREATOR_LOG.txt - Agent A's notes
4. VERIFIER_LOG.txt - Agent B's notes
5. OUTPUT/ folder - deliverables

STATUS values:
- pending - not started
- in_progress - Agent A working
- ready_for_verification - Agent A done, waiting for Agent B
- needs_revision - Agent B found issues
- completed - both agents approved
- failed - cannot complete

================================================================================

10. MANDATORY READING BEFORE STARTING
=====================================

**CRITICAL: You MUST read these files BEFORE starting ANY work:**

1. **THE PAPER (MOST IMPORTANT!):**
   D:\Dropbox\Research\PRIMING_TOOLBOX\sivroni2025_24nov25_v1.pdf
   - This is the theoretical foundation of the entire project
   - Explains the ABCD framework
   - Defines the three characteristics of priming
   - You cannot build experiments without understanding this!

2. **Project documentation (in order):**
   - AGENT_INSTRUCTIONS.txt (this file)
   - ARCHITECTURE_DECISIONS_23_DEC_2025.txt
   - SUMMARY_FOR_CLAUDE_DECEMBER_2025.md
   - PrimingToolbox_Project_Plan-v1.md

3. **All files in the project folder:**
   D:\Dropbox\Research\PRIMING_TOOLBOX\
   - Read ALL .txt and .md files
   - Understand the existing code structure
   - Check experiments/ folder for JSON configs

4. Check your assigned PAIR_XX folder for TASK.txt

Remember:
- NEVER overwrite existing files
- Always copy to new version first
- Document everything in your log file
- Ask for clarification if task is unclear

================================================================================

11. QUALITY CHECKLIST
=====================

Before marking as complete, verify:

[ ] Code runs without errors
[ ] Supabase data saving works
[ ] Visual design matches existing (glassmorphism, colors)
[ ] Response keys work correctly
[ ] Timing is accurate
[ ] No hardcoded values that should be configurable
[ ] Works on Chrome, Firefox, Safari
[ ] Mobile-responsive (if applicable)
[ ] All log files are updated
[ ] Output folder contains all deliverables

================================================================================

12. FOLDER STRUCTURE
====================

PRIMING_TOOLBOX/
├── AGENTS/                      # Agent work folders
│   ├── AGENT_INSTRUCTIONS.txt   # This file
│   ├── PAIR_01_STROOP/
│   ├── PAIR_02_SEMANTIC/
│   └── ...
├── HTMLs/                       # Dated HTML backups
│   ├── 23_DECEMBER_2025/
│   └── ...
├── core/                        # Shared modules (to be built)
├── paradigms/                   # Base paradigms (to be built)
├── experiments/                 # Built-in experiments
├── js/                          # Current JavaScript files
├── css/                         # Current CSS files
├── index.html                   # Main entry point
└── *.md, *.txt                  # Documentation

================================================================================

Written by: Claude (Opus 4.5)
For: Dr. Shir Sivroni
Date: 23 December 2025

================================================================================
